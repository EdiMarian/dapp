{"ast":null,"code":"\"use strict\";\n\nvar _classCallCheck = require(\"/Users/ediichim/Documents/workspace/temp/estar dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/ediichim/Documents/workspace/temp/estar dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function get() {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) {\n    if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  }\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UserPublicKey = exports.UserSecretKey = exports.USER_PUBKEY_LENGTH = exports.USER_SEED_LENGTH = void 0;\n\nvar tweetnacl = __importStar(require(\"tweetnacl\"));\n\nvar address_1 = require(\"../address\");\n\nvar utils_1 = require(\"../utils\");\n\nvar pem_1 = require(\"./pem\");\n\nvar logger_1 = require(\"../logger\");\n\nexports.USER_SEED_LENGTH = 32;\nexports.USER_PUBKEY_LENGTH = 32;\n\nvar UserSecretKey = /*#__PURE__*/function () {\n  function UserSecretKey(buffer) {\n    _classCallCheck(this, UserSecretKey);\n\n    utils_1.guardLength(buffer, exports.USER_SEED_LENGTH);\n    this.buffer = buffer;\n  }\n\n  _createClass(UserSecretKey, [{\n    key: \"generatePublicKey\",\n    value: function generatePublicKey() {\n      var keyPair = tweetnacl.sign.keyPair.fromSeed(new Uint8Array(this.buffer));\n      var buffer = Buffer.from(keyPair.publicKey);\n      return new UserPublicKey(buffer);\n    }\n  }, {\n    key: \"sign\",\n    value: function sign(message) {\n      var pair = tweetnacl.sign.keyPair.fromSeed(new Uint8Array(this.buffer));\n      var signingKey = pair.secretKey;\n      var signature = tweetnacl.sign(new Uint8Array(message), signingKey); // \"tweetnacl.sign()\" returns the concatenated [signature, message], therfore we remove the appended message:\n\n      signature = signature.slice(0, signature.length - message.length);\n      return Buffer.from(signature);\n    }\n  }, {\n    key: \"hex\",\n    value: function hex() {\n      return this.buffer.toString(\"hex\");\n    }\n  }, {\n    key: \"valueOf\",\n    value: function valueOf() {\n      return this.buffer;\n    }\n  }], [{\n    key: \"fromString\",\n    value: function fromString(value) {\n      utils_1.guardLength(value, exports.USER_SEED_LENGTH * 2);\n      var buffer = Buffer.from(value, \"hex\");\n      return new UserSecretKey(buffer);\n    }\n  }, {\n    key: \"fromPem\",\n    value: function fromPem(text) {\n      var index = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      return pem_1.parseUserKey(text, index);\n    }\n  }]);\n\n  return UserSecretKey;\n}();\n\nexports.UserSecretKey = UserSecretKey;\n\nvar UserPublicKey = /*#__PURE__*/function () {\n  function UserPublicKey(buffer) {\n    _classCallCheck(this, UserPublicKey);\n\n    utils_1.guardLength(buffer, exports.USER_PUBKEY_LENGTH);\n    this.buffer = buffer;\n  }\n\n  _createClass(UserPublicKey, [{\n    key: \"verify\",\n    value: function verify(message, signature) {\n      try {\n        var unopenedMessage = Buffer.concat([signature, message]);\n        var unsignedMessage = tweetnacl.sign.open(unopenedMessage, this.buffer);\n        return unsignedMessage != null;\n      } catch (err) {\n        logger_1.Logger.error(err);\n        return false;\n      }\n    }\n  }, {\n    key: \"hex\",\n    value: function hex() {\n      return this.buffer.toString(\"hex\");\n    }\n  }, {\n    key: \"toAddress\",\n    value: function toAddress() {\n      return new address_1.Address(this.buffer);\n    }\n  }, {\n    key: \"valueOf\",\n    value: function valueOf() {\n      return this.buffer;\n    }\n  }]);\n\n  return UserPublicKey;\n}();\n\nexports.UserPublicKey = UserPublicKey;","map":{"version":3,"sources":["../../src/walletcore/userKeys.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.UserPublicKey = exports.UserSecretKey = exports.USER_PUBKEY_LENGTH = exports.USER_SEED_LENGTH = void 0;\nconst tweetnacl = __importStar(require(\"tweetnacl\"));\nconst address_1 = require(\"../address\");\nconst utils_1 = require(\"../utils\");\nconst pem_1 = require(\"./pem\");\nconst logger_1 = require(\"../logger\");\nexports.USER_SEED_LENGTH = 32;\nexports.USER_PUBKEY_LENGTH = 32;\nclass UserSecretKey {\n    constructor(buffer) {\n        utils_1.guardLength(buffer, exports.USER_SEED_LENGTH);\n        this.buffer = buffer;\n    }\n    static fromString(value) {\n        utils_1.guardLength(value, exports.USER_SEED_LENGTH * 2);\n        let buffer = Buffer.from(value, \"hex\");\n        return new UserSecretKey(buffer);\n    }\n    static fromPem(text, index = 0) {\n        return pem_1.parseUserKey(text, index);\n    }\n    generatePublicKey() {\n        let keyPair = tweetnacl.sign.keyPair.fromSeed(new Uint8Array(this.buffer));\n        let buffer = Buffer.from(keyPair.publicKey);\n        return new UserPublicKey(buffer);\n    }\n    sign(message) {\n        let pair = tweetnacl.sign.keyPair.fromSeed(new Uint8Array(this.buffer));\n        let signingKey = pair.secretKey;\n        let signature = tweetnacl.sign(new Uint8Array(message), signingKey);\n        // \"tweetnacl.sign()\" returns the concatenated [signature, message], therfore we remove the appended message:\n        signature = signature.slice(0, signature.length - message.length);\n        return Buffer.from(signature);\n    }\n    hex() {\n        return this.buffer.toString(\"hex\");\n    }\n    valueOf() {\n        return this.buffer;\n    }\n}\nexports.UserSecretKey = UserSecretKey;\nclass UserPublicKey {\n    constructor(buffer) {\n        utils_1.guardLength(buffer, exports.USER_PUBKEY_LENGTH);\n        this.buffer = buffer;\n    }\n    verify(message, signature) {\n        try {\n            const unopenedMessage = Buffer.concat([signature, message]);\n            const unsignedMessage = tweetnacl.sign.open(unopenedMessage, this.buffer);\n            return unsignedMessage != null;\n        }\n        catch (err) {\n            logger_1.Logger.error(err);\n            return false;\n        }\n    }\n    hex() {\n        return this.buffer.toString(\"hex\");\n    }\n    toAddress() {\n        return new address_1.Address(this.buffer);\n    }\n    valueOf() {\n        return this.buffer;\n    }\n}\nexports.UserPublicKey = UserPublicKey;\n//# sourceMappingURL=userKeys.js.map"]},"metadata":{},"sourceType":"script"}