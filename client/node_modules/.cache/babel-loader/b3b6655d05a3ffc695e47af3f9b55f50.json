{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/ediichim/Documents/workspace/temp/delegation-dashboard.elrond.com/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nvar _classCallCheck = require(\"/Users/ediichim/Documents/workspace/temp/delegation-dashboard.elrond.com/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/ediichim/Documents/workspace/temp/delegation-dashboard.elrond.com/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ExtensionProvider = void 0;\n\nvar signableMessage_1 = require(\"../signableMessage\");\n\nvar signature_1 = require(\"../signature\");\n\nvar transaction_1 = require(\"../transaction\");\n\nvar ExtensionProvider = /*#__PURE__*/function () {\n  function ExtensionProvider() {\n    _classCallCheck(this, ExtensionProvider);\n\n    this.initialized = false;\n\n    if (ExtensionProvider._instance) {\n      throw new Error(\"Error: Instantiation failed: Use ExtensionProvider.getInstance() instead of new.\");\n    }\n\n    this.account = {\n      address: \"\"\n    };\n    ExtensionProvider._instance = this;\n  }\n\n  _createClass(ExtensionProvider, [{\n    key: \"setAddress\",\n    value: function setAddress(address) {\n      this.account.address = address;\n      return ExtensionProvider._instance;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (window && window.elrondWallet) {\n                  this.initialized = true;\n                }\n\n                return _context.abrupt(\"return\", this.initialized);\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n    }\n  }, {\n    key: \"login\",\n    value: function login() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var token, data;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (this.initialized) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                throw new Error(\"Extension provider is not initialised, call init() first\");\n\n              case 2:\n                token = options.token;\n                data = token ? token : \"\";\n                _context2.next = 6;\n                return this.startBgrMsgChannel(\"connect\", data);\n\n              case 6:\n                return _context2.abrupt(\"return\", this.account.address);\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n    }\n  }, {\n    key: \"logout\",\n    value: function logout() {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (this.initialized) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                throw new Error(\"Extension provider is not initialised, call init() first\");\n\n              case 2:\n                _context3.prev = 2;\n                _context3.next = 5;\n                return this.startBgrMsgChannel(\"logout\", this.account.address);\n\n              case 5:\n                _context3.next = 10;\n                break;\n\n              case 7:\n                _context3.prev = 7;\n                _context3.t0 = _context3[\"catch\"](2);\n                console.warn(\"Extension origin url is already cleared!\", _context3.t0);\n\n              case 10:\n                return _context3.abrupt(\"return\", true);\n\n              case 11:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[2, 7]]);\n      }));\n    }\n  }, {\n    key: \"getAddress\",\n    value: function getAddress() {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (this.initialized) {\n                  _context4.next = 2;\n                  break;\n                }\n\n                throw new Error(\"Extension provider is not initialised, call init() first\");\n\n              case 2:\n                return _context4.abrupt(\"return\", this.account ? this.account.address : \"\");\n\n              case 3:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n    }\n  }, {\n    key: \"isInitialized\",\n    value: function isInitialized() {\n      return this.initialized;\n    }\n  }, {\n    key: \"isConnected\",\n    value: function isConnected() {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                return _context5.abrupt(\"return\", !!this.account);\n\n              case 1:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n    }\n  }, {\n    key: \"sendTransaction\",\n    value: function sendTransaction(transaction) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n        var txResponse;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return this.startBgrMsgChannel(\"sendTransactions\", {\n                  from: this.account.address,\n                  transactions: [transaction.toPlainObject()]\n                });\n\n              case 2:\n                txResponse = _context6.sent;\n                return _context6.abrupt(\"return\", transaction_1.Transaction.fromPlainObject(txResponse[0]));\n\n              case 4:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n    }\n  }, {\n    key: \"signTransaction\",\n    value: function signTransaction(transaction) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n        var txResponse;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.next = 2;\n                return this.startBgrMsgChannel(\"signTransactions\", {\n                  from: this.account.address,\n                  transactions: [transaction.toPlainObject()]\n                });\n\n              case 2:\n                txResponse = _context7.sent;\n                return _context7.abrupt(\"return\", transaction_1.Transaction.fromPlainObject(txResponse[0]));\n\n              case 4:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n    }\n  }, {\n    key: \"signTransactions\",\n    value: function signTransactions(transactions) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n        var txResponse;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                transactions = transactions.map(function (transaction) {\n                  return transaction.toPlainObject();\n                });\n                _context8.next = 3;\n                return this.startBgrMsgChannel(\"signTransactions\", {\n                  from: this.account.address,\n                  transactions: transactions\n                });\n\n              case 3:\n                txResponse = _context8.sent;\n                _context8.prev = 4;\n                txResponse = txResponse.map(function (transaction) {\n                  return transaction_1.Transaction.fromPlainObject(transaction);\n                });\n                _context8.next = 11;\n                break;\n\n              case 8:\n                _context8.prev = 8;\n                _context8.t0 = _context8[\"catch\"](4);\n                throw new Error(\"Transaction canceled.\");\n\n              case 11:\n                return _context8.abrupt(\"return\", txResponse);\n\n              case 12:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this, [[4, 8]]);\n      }));\n    }\n  }, {\n    key: \"signMessage\",\n    value: function signMessage(message) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n        var data, signResponse, signedMsg;\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                data = {\n                  account: this.account.address,\n                  message: message.message.toString()\n                };\n                _context9.next = 3;\n                return this.startBgrMsgChannel(\"signMessage\", data);\n\n              case 3:\n                signResponse = _context9.sent;\n                signedMsg = new signableMessage_1.SignableMessage({\n                  address: message.address,\n                  message: Buffer.from(signResponse.message),\n                  signature: new signature_1.Signature(signResponse.signature)\n                });\n                return _context9.abrupt(\"return\", signedMsg);\n\n              case 6:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n    }\n  }, {\n    key: \"cancelAction\",\n    value: function cancelAction() {\n      return this.startBgrMsgChannel(\"cancelAction\", {});\n    }\n  }, {\n    key: \"startBgrMsgChannel\",\n    value: function startBgrMsgChannel(operation, connectData) {\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        window.postMessage({\n          target: \"erdw-inpage\",\n          type: operation,\n          data: connectData\n        }, window.origin);\n\n        var eventHandler = function eventHandler(event) {\n          if (event.isTrusted && event.data.target === \"erdw-contentScript\") {\n            if (event.data.type === \"connectResponse\") {\n              _this.account = event.data.data;\n              window.removeEventListener(\"message\", eventHandler);\n              resolve(event.data.data);\n            } else {\n              window.removeEventListener(\"message\", eventHandler);\n              resolve(event.data.data);\n            }\n          }\n        };\n\n        window.addEventListener(\"message\", eventHandler, false);\n      });\n    }\n  }], [{\n    key: \"getInstance\",\n    value: function getInstance() {\n      return ExtensionProvider._instance;\n    }\n  }]);\n\n  return ExtensionProvider;\n}();\n\nexports.ExtensionProvider = ExtensionProvider;\nExtensionProvider._instance = new ExtensionProvider();","map":{"version":3,"sources":["../../src/dapp/extensionProvider.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ExtensionProvider = void 0;\nconst signableMessage_1 = require(\"../signableMessage\");\nconst signature_1 = require(\"../signature\");\nconst transaction_1 = require(\"../transaction\");\nclass ExtensionProvider {\n    constructor() {\n        this.initialized = false;\n        if (ExtensionProvider._instance) {\n            throw new Error(\"Error: Instantiation failed: Use ExtensionProvider.getInstance() instead of new.\");\n        }\n        this.account = { address: \"\" };\n        ExtensionProvider._instance = this;\n    }\n    static getInstance() {\n        return ExtensionProvider._instance;\n    }\n    setAddress(address) {\n        this.account.address = address;\n        return ExtensionProvider._instance;\n    }\n    init() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (window && window.elrondWallet) {\n                this.initialized = true;\n            }\n            return this.initialized;\n        });\n    }\n    login(options = {}) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.initialized) {\n                throw new Error(\"Extension provider is not initialised, call init() first\");\n            }\n            const { token } = options;\n            const data = token ? token : \"\";\n            yield this.startBgrMsgChannel(\"connect\", data);\n            return this.account.address;\n        });\n    }\n    logout() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.initialized) {\n                throw new Error(\"Extension provider is not initialised, call init() first\");\n            }\n            try {\n                yield this.startBgrMsgChannel(\"logout\", this.account.address);\n            }\n            catch (error) {\n                console.warn(\"Extension origin url is already cleared!\", error);\n            }\n            return true;\n        });\n    }\n    getAddress() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.initialized) {\n                throw new Error(\"Extension provider is not initialised, call init() first\");\n            }\n            return this.account ? this.account.address : \"\";\n        });\n    }\n    isInitialized() {\n        return this.initialized;\n    }\n    isConnected() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return !!this.account;\n        });\n    }\n    sendTransaction(transaction) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const txResponse = yield this.startBgrMsgChannel(\"sendTransactions\", {\n                from: this.account.address,\n                transactions: [transaction.toPlainObject()],\n            });\n            return transaction_1.Transaction.fromPlainObject(txResponse[0]);\n        });\n    }\n    signTransaction(transaction) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const txResponse = yield this.startBgrMsgChannel(\"signTransactions\", {\n                from: this.account.address,\n                transactions: [transaction.toPlainObject()],\n            });\n            return transaction_1.Transaction.fromPlainObject(txResponse[0]);\n        });\n    }\n    signTransactions(transactions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            transactions = transactions.map((transaction) => transaction.toPlainObject());\n            let txResponse = yield this.startBgrMsgChannel(\"signTransactions\", {\n                from: this.account.address,\n                transactions: transactions,\n            });\n            try {\n                txResponse = txResponse.map((transaction) => transaction_1.Transaction.fromPlainObject(transaction));\n            }\n            catch (error) {\n                throw new Error(\"Transaction canceled.\");\n            }\n            return txResponse;\n        });\n    }\n    signMessage(message) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const data = {\n                account: this.account.address,\n                message: message.message.toString(),\n            };\n            const signResponse = yield this.startBgrMsgChannel(\"signMessage\", data);\n            const signedMsg = new signableMessage_1.SignableMessage({\n                address: message.address,\n                message: Buffer.from(signResponse.message),\n                signature: new signature_1.Signature(signResponse.signature),\n            });\n            return signedMsg;\n        });\n    }\n    cancelAction() {\n        return this.startBgrMsgChannel(\"cancelAction\", {});\n    }\n    startBgrMsgChannel(operation, connectData) {\n        return new Promise((resolve) => {\n            window.postMessage({\n                target: \"erdw-inpage\",\n                type: operation,\n                data: connectData,\n            }, window.origin);\n            const eventHandler = (event) => {\n                if (event.isTrusted && event.data.target === \"erdw-contentScript\") {\n                    if (event.data.type === \"connectResponse\") {\n                        this.account = event.data.data;\n                        window.removeEventListener(\"message\", eventHandler);\n                        resolve(event.data.data);\n                    }\n                    else {\n                        window.removeEventListener(\"message\", eventHandler);\n                        resolve(event.data.data);\n                    }\n                }\n            };\n            window.addEventListener(\"message\", eventHandler, false);\n        });\n    }\n}\nexports.ExtensionProvider = ExtensionProvider;\nExtensionProvider._instance = new ExtensionProvider();\n//# sourceMappingURL=extensionProvider.js.map"]},"metadata":{},"sourceType":"script"}