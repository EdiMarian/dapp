{"ast":null,"code":"\"use strict\";\n\nvar _classCallCheck = require(\"/Users/ediichim/Documents/workspace/temp/delegation-dashboard.elrond.com/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/ediichim/Documents/workspace/temp/delegation-dashboard.elrond.com/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SignableMessage = exports.MESSAGE_PREFIX = void 0;\n\nvar signature_1 = require(\"./signature\");\n\nvar address_1 = require(\"./address\");\n\nvar createKeccakHash = require(\"keccak\");\n\nexports.MESSAGE_PREFIX = \"\\x17Elrond Signed Message:\\n\";\n\nvar SignableMessage = /*#__PURE__*/function () {\n  function SignableMessage(init) {\n    _classCallCheck(this, SignableMessage);\n\n    this.message = Buffer.from([]);\n    this.signature = new signature_1.Signature();\n    this.version = 1;\n    this.signer = \"ErdJS\";\n    this.address = new address_1.Address();\n    Object.assign(this, init);\n  }\n\n  _createClass(SignableMessage, [{\n    key: \"serializeForSigning\",\n    value: function serializeForSigning() {\n      var messageSize = Buffer.from(this.message.length.toString());\n      var signableMessage = Buffer.concat([messageSize, this.message]);\n      var bytesToHash = Buffer.concat([Buffer.from(exports.MESSAGE_PREFIX), signableMessage]);\n      return createKeccakHash(\"keccak256\").update(bytesToHash).digest();\n    }\n  }, {\n    key: \"serializeForSigningRaw\",\n    value: function serializeForSigningRaw() {\n      return Buffer.concat([this.getMessageSize(), this.message]);\n    }\n  }, {\n    key: \"getSignature\",\n    value: function getSignature() {\n      return this.signature;\n    }\n  }, {\n    key: \"applySignature\",\n    value: function applySignature(signature) {\n      this.signature = signature;\n    }\n  }, {\n    key: \"getMessageSize\",\n    value: function getMessageSize() {\n      var messageSize = Buffer.alloc(4);\n      messageSize.writeUInt32BE(this.message.length, 0);\n      return messageSize;\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        address: this.address.bech32(),\n        message: \"0x\" + this.message.toString('hex'),\n        signature: \"0x\" + this.signature.hex(),\n        version: this.version,\n        signer: this.signer\n      };\n    }\n  }]);\n\n  return SignableMessage;\n}();\n\nexports.SignableMessage = SignableMessage;","map":{"version":3,"sources":["../src/signableMessage.ts"],"names":[],"mappings":";;;;;;;;;;;AACA,IAAA,WAAA,GAAA,OAAA,CAAA,aAAA,CAAA;;AACA,IAAA,SAAA,GAAA,OAAA,CAAA,WAAA,CAAA;;AAEA,IAAM,gBAAgB,GAAG,OAAO,CAAC,QAAD,CAAhC;;AAEa,OAAA,CAAA,cAAA,GAAiB,8BAAjB;;IAEA,e;AA0BX,2BAAmB,IAAnB,EAAkD;AAAA;;AAChD,SAAK,OAAL,GAAe,MAAM,CAAC,IAAP,CAAY,EAAZ,CAAf;AACA,SAAK,SAAL,GAAiB,IAAI,WAAA,CAAA,SAAJ,EAAjB;AACA,SAAK,OAAL,GAAe,CAAf;AACA,SAAK,MAAL,GAAc,OAAd;AACA,SAAK,OAAL,GAAe,IAAI,SAAA,CAAA,OAAJ,EAAf;AAEA,IAAA,MAAM,CAAC,MAAP,CAAc,IAAd,EAAoB,IAApB;AACD;;;;WAED,+BAAmB;AACjB,UAAM,WAAW,GAAG,MAAM,CAAC,IAAP,CAAY,KAAK,OAAL,CAAa,MAAb,CAAoB,QAApB,EAAZ,CAApB;AACA,UAAM,eAAe,GAAG,MAAM,CAAC,MAAP,CAAc,CAAC,WAAD,EAAc,KAAK,OAAnB,CAAd,CAAxB;AACA,UAAI,WAAW,GAAG,MAAM,CAAC,MAAP,CAAc,CAAC,MAAM,CAAC,IAAP,CAAY,OAAA,CAAA,cAAZ,CAAD,EAA8B,eAA9B,CAAd,CAAlB;AAEA,aAAO,gBAAgB,CAAC,WAAD,CAAhB,CAA8B,MAA9B,CAAqC,WAArC,EAAkD,MAAlD,EAAP;AACD;;;WAED,kCAAsB;AACpB,aAAO,MAAM,CAAC,MAAP,CAAc,CAAC,KAAK,cAAL,EAAD,EAAwB,KAAK,OAA7B,CAAd,CAAP;AACD;;;WAED,wBAAY;AACV,aAAO,KAAK,SAAZ;AACD;;;WAED,wBAAe,SAAf,EAAmC;AACjC,WAAK,SAAL,GAAiB,SAAjB;AACD;;;WAED,0BAAc;AACZ,UAAM,WAAW,GAAG,MAAM,CAAC,KAAP,CAAa,CAAb,CAApB;AACA,MAAA,WAAW,CAAC,aAAZ,CAA0B,KAAK,OAAL,CAAa,MAAvC,EAA+C,CAA/C;AAEA,aAAO,WAAP;AACD;;;WAED,kBAAM;AACJ,aAAO;AACL,QAAA,OAAO,EAAE,KAAK,OAAL,CAAa,MAAb,EADJ;AAEL,QAAA,OAAO,EAAE,OAAO,KAAK,OAAL,CAAa,QAAb,CAAsB,KAAtB,CAFX;AAGL,QAAA,SAAS,EAAE,OAAO,KAAK,SAAL,CAAe,GAAf,EAHb;AAIL,QAAA,OAAO,EAAE,KAAK,OAJT;AAKL,QAAA,MAAM,EAAE,KAAK;AALR,OAAP;AAOD;;;;;;AAvEH,OAAA,CAAA,eAAA,GAAA,eAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SignableMessage = exports.MESSAGE_PREFIX = void 0;\nconst signature_1 = require(\"./signature\");\nconst address_1 = require(\"./address\");\nconst createKeccakHash = require(\"keccak\");\nexports.MESSAGE_PREFIX = \"\\x17Elrond Signed Message:\\n\";\nclass SignableMessage {\n    constructor(init) {\n        this.message = Buffer.from([]);\n        this.signature = new signature_1.Signature();\n        this.version = 1;\n        this.signer = \"ErdJS\";\n        this.address = new address_1.Address();\n        Object.assign(this, init);\n    }\n    serializeForSigning() {\n        const messageSize = Buffer.from(this.message.length.toString());\n        const signableMessage = Buffer.concat([messageSize, this.message]);\n        let bytesToHash = Buffer.concat([Buffer.from(exports.MESSAGE_PREFIX), signableMessage]);\n        return createKeccakHash(\"keccak256\").update(bytesToHash).digest();\n    }\n    serializeForSigningRaw() {\n        return Buffer.concat([this.getMessageSize(), this.message]);\n    }\n    getSignature() {\n        return this.signature;\n    }\n    applySignature(signature) {\n        this.signature = signature;\n    }\n    getMessageSize() {\n        const messageSize = Buffer.alloc(4);\n        messageSize.writeUInt32BE(this.message.length, 0);\n        return messageSize;\n    }\n    toJSON() {\n        return {\n            address: this.address.bech32(),\n            message: \"0x\" + this.message.toString('hex'),\n            signature: \"0x\" + this.signature.hex(),\n            version: this.version,\n            signer: this.signer,\n        };\n    }\n}\nexports.SignableMessage = SignableMessage;\n//# sourceMappingURL=signableMessage.js.map"]},"metadata":{},"sourceType":"script"}